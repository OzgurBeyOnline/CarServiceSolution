@using CarService.Web.Models
@using CarService.Web.ViewModels
@model CarService.Web.ViewModels.RegisterViewModel
@{
    ViewData["Title"] = "Anasayfa";
    Layout = "_Layout";
    var services = (IEnumerable<ServiceType>)(ViewBag.ServiceTypes ?? Enumerable.Empty<ServiceType>());
    var showLogin = Context.Request.Query["showLogin"] == "true";
    var apptVm = (CarService.Web.ViewModels.AppointmentCreateViewModel?)ViewBag.ApptVm;
    var serviceTypes = ViewBag.ServiceTypes as IEnumerable<ServiceType> 
                       ?? Enumerable.Empty<ServiceType>();
    var pageContents = ViewBag.PageContents as IList<PageContent> 
                       ?? Enumerable.Empty<PageContent>();
}

@section Styles {
    <style>
      .card-hero {
        width: 100%; max-width: 800px;
        height: 500px;
        position: relative;
        overflow: hidden;
        border-radius: 1rem;
        box-shadow: 0 .5rem 1rem rgba(0,0,0,.1);
        background: #f8f9fa;
      }

      /* İçerik: 2 panel x %50 yükseklik = toplam %200 */
      .card-hero .inner {
        position: absolute; top: 0; left: 0;
        width: 100%; height: 200%;
        display: flex;
        flex-direction: column;
        transition: transform .6s ease;
      }

      /* Her panel %50 yüksekliğinde */
      .card-hero .panel {
        width: 100%;
        height: 50%;
      }

      /* Panel içi kolonlar tam yükseklik alsın */
      .card-hero .panel .col-md-6 {
        height: 100%;
      }

      /* renk düzeni */
      #panel1 .bg-primary,
      #panel2 .bg-primary { color: white; }

      #misyonVizyon h2 {
        font-weight: 600;
        color: #0d6efd;
      }
      #misyonVizyon p {
        font-size: 1.1rem;
        line-height: 1.6;
        color: #333;
      }
    </style>
}


@* ====== Dinamik Admin Tarafından Girilmiş İçerikler ======*@
@foreach (var pc in pageContents.OrderBy(pc => pc.DisplayOrder))
{
    <section id="@pc.Key.ToLower()" class="my-5">
        @Html.Raw(pc.Html)
    </section>
}
@* ========================================================= *@


<section class="vh-100 d-flex justify-content-center align-items-center bg-light">
  <div class="text-center">
    <h1>Randevunuzu şimdi oluşturun!</h1>
    <p>En uygun zamanınızı hemen ayarlayın.</p>

    @if (User.Identity?.IsAuthenticated ?? false)
    {
      <a asp-controller="Appointments" asp-action="Create" class="btn btn-primary btn-lg">
        Randevu Oluştur
      </a>
    }
    else
    {
      <a asp-controller="Account" asp-action="Auth" class="btn btn-primary btn-lg">
        Giriş Yap / Kayıt Ol
      </a>
    }
  </div>
</section>

@* Hizmetlerimiz bölümü *@
<section id="services" class="vh-100 d-flex align-items-center">
  <div class="container">
    <h2 class="text-center mb-5">Hizmetlerimiz</h2>
    <div class="row g-4">
      @foreach (var st in serviceTypes)
      {
        <div class="col-md-4">
          <div class="card h-100 position-relative">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">@st.Name</h5>
              <p class="card-text">@st.Description</p>
              <hr class="my-2" />

              @* En güncel fiyatı göster *@
             @{
                  var price = st.Pricings.FirstOrDefault()?.Price;
              }
              <p class="fw-bold mt-auto">
                  @(price.HasValue ? $"{price.Value:N2} TL" : "—")
              </p>
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</section>


<section id="misyonVizyon" class="vh-100 d-flex align-items-center bg-light">
  <div class="container">
    <div class="row gy-5">
      <div class="col-md-6 d-flex flex-column justify-content-center">
        <h2 class="mb-3">Misyonumuz</h2>
        <p>
          Firmamızın misyonu, aracınızın güvenliğini ve performansını
          en üst seviyede tutmak için kaliteli hizmet sunmaktır. Müşterilerimize
          şeffaf fiyat politikası, hızlı ve uzman çözümlerle her zaman yanlarında
          olmayı taahhüt ederiz.
        </p>
      </div>
      <div class="col-md-6 d-flex flex-column justify-content-center">
        <h2 class="mb-3">Vizyonumuz</h2>
        <p>
          Otomotiv servisinde sektöre yön veren bir referans noktası olmak;
          teknolojiyi yakından takip ederek yenilikçi ve çevre dostu çözümler
          geliştirmek; müşteri memnuniyetini daima en üst düzeyde tutmak
          vizyonumuzun temelini oluşturur.
        </p>
      </div>
    </div>
  </div>
</section>

<section id="hakkimizda" class="vh-100 d-flex align-items-center bg-white">
  <div class="container">
    <div class="row gy-4">
      <div class="col-md-6 d-flex flex-column justify-content-center">
        <h2>Daha fazla öğrenmek ister misiniz?</h2>
        <p>Hemen butona tıklayın ve bizi keşfetmeye başlayın!</p>
        <a href="@Url.Action("About","Home")" class="btn btn-primary">Bizi Keşfet</a>
      </div>
      <div class="col-md-6 d-flex flex-column justify-content-center">
        <h2>Hakkımızda</h2>
        <p>
          CarService ailesi olarak yılların verdiği tecrübe ve
          uzman kadromuzla araç bakım ve onarımında en güvenilir
          adres olmayı hedefliyoruz. Teknolojik ekipmanlarımız ve
          müşteri odaklı yaklaşımımız sayesinde, aracınızı ilk gün
          ki performansıyla yola devam ettiriyoruz.
        </p>
      </div>
    </div>
  </div>
</section>

<section id="iletisim-cta" class="bg-secondary text-white py-3">
  <div class="container d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Bizimle iletişime geçmek ister misiniz?</h5>
    <a asp-controller="Home" asp-action="Contact" class="btn btn-light">
      İletişim Sayfası
    </a>
  </div>
</section>

@section Scripts {
  <partial name="_ValidationScriptsPartial" />
  <script>
    const inner = document.getElementById('heroInner');

    // Buton tıklamaları
    document.getElementById('btnToLogin').addEventListener('click', () => {
      inner.style.transform = 'translateY(-50%)';
    });
    document.getElementById('btnToRegister').addEventListener('click', () => {
      inner.style.transform = 'translateY(0)';
    });
  </script>
}

@using CarService.Web.Models
@using CarService.Web.ViewModels
@model CarService.Web.ViewModels.RegisterViewModel
@{
    ViewData["Title"] = "Anasayfa";
    Layout = "_Layout";
    var services = (IEnumerable<ServiceType>)(ViewBag.ServiceTypes ?? Enumerable.Empty<ServiceType>());
    var showLogin = Context.Request.Query["showLogin"] == "true";
    var apptVm = (CarService.Web.ViewModels.AppointmentCreateViewModel?)ViewBag.ApptVm;
    var serviceTypes = ViewBag.ServiceTypes as IEnumerable<ServiceType> 
                       ?? Enumerable.Empty<ServiceType>();
    var sec = (Dictionary<string,string>)ViewBag.Sections;
    var data = Model;
}

@section Styles {
    <style>
      body {
        background-color: #121212;
        color: #f1f1f1;
        font-family: 'Segoe UI', sans-serif;
      }

      section {
        background-color: transparent !important;
      }

      h1, h2, h5 {
        color: #ffffff;
      }

      a, a.btn {
        transition: all 0.3s ease-in-out;
      }

      .card-hero {
        width: 100%; max-width: 800px;
        height: 500px;
        position: relative;
        overflow: hidden;
        border-radius: 1rem;
        box-shadow: 0 .5rem 1rem rgba(0,0,0,.1);
        background: #f8f9fa;
      }

      .card {
        background-color: #1e1e1e;
        border: 1px solid #2c2c2c;
        color: #f1f1f1;
        box-shadow: 0 0 15px rgba(0,0,0,0.2);
      }
      .card:hover {
        transform: scale(1.03);
        border-color: #3a3a3a;
      }

      .btn-primary {
        background-color: #0d6efd;
        border-color: #0d6efd;
      }
      .btn-primary:hover {
        background-color: #0b5ed7;
      }

      #misyonVizyon h2,
      #hakkimizda h2 {
        color: #0d6efd;
      }

      .bg-light {
        background-color: #1a1a1a !important;
      }

      .bg-white {
        background-color: #1e1e1e !important;
      }

      .bg-secondary {
        background-color: transparent !important;
        backdrop-filter: none;
        box-shadow: none;
      }

      .text-white {
        color: #f1f1f1 !important;
      }


      /* İçerik: 2 panel x %50 yükseklik = toplam %200 */
      .card-hero .inner {
        position: absolute; top: 0; left: 0;
        width: 100%; height: 200%;
        display: flex;
        flex-direction: column;
        transition: transform .6s ease;
      }

      /* Her panel %50 yüksekliğinde */
      .card-hero .panel {
        width: 100%;
        height: 50%;
      }

      /* Panel içi kolonlar tam yükseklik alsın */
      .card-hero .panel .col-md-6 {
        height: 100%;
      }

      /* renk düzeni */
      #panel1 .bg-primary,
      #panel2 .bg-primary { color: white; }

      #misyonVizyon h2 {
        font-weight: 600;
        color: #0d6efd;
      }
      #misyonVizyon p {
        font-size: 1.1rem;
        line-height: 1.6;
        color: #333;
      }
    </style>
}


<section class="vh-100 d-flex justify-content-center align-items-center bg-light">
  <div class="text-center">
    <h1>Randevunuzu şimdi oluşturun!</h1>
    <p>En uygun zamanınızı hemen ayarlayın.</p>

    @if (User.Identity?.IsAuthenticated ?? false)
    {
      <a asp-controller="Appointments" asp-action="Create" class="btn btn-primary btn-lg">
        Randevu Oluştur
      </a>
    }
    else
    {
      <a asp-controller="Account" asp-action="Auth" class="btn btn-primary btn-lg">
        Giriş Yap / Kayıt Ol
      </a>
    }
  </div>
</section>

@* Hizmetlerimiz bölümü *@
<section id="services" class="vh-100 d-flex align-items-center">
  <div class="container">
    <h2 class="text-center mb-5">Hizmetlerimiz</h2>
    <div class="row g-4">
      @foreach (var st in serviceTypes)
      {
        <div class="col-md-4">
          <div class="card h-100 position-relative">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">@st.Name</h5>
              <p class="card-text">@st.Description</p>
              <hr class="my-2" />

              @* En güncel fiyatı göster *@
             @{
                  var price = st.Pricings.FirstOrDefault()?.Price;
              }
              <p class="fw-bold mt-auto">
                  @(price.HasValue ? $"{price.Value:N2} TL" : "—")
              </p>
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</section>


@* Misyon/Vizyon *@
<section id="misyonVizyon" class="vh-100 d-flex align-items-center bg-light" style="margin-top: 7rem;">
  <div class="container">
    <div class="row gy-5">
      <div class="col-md-6 d-flex flex-column justify-content-center">
        <h2 class="mb-3">
          @sec.GetValueOrDefault("MisyonTitle", "Misyon başlığı bulunamadı")
        </h2>
        <p style="color: #fff;">
          @Html.Raw(sec.GetValueOrDefault("MisyonText", "<em>Misyon metni yok</em>"))
        </p>
      </div>
      <div class="col-md-6 d-flex flex-column justify-content-center">
        <h2 class="mb-3">
          @sec.GetValueOrDefault("VizyonTitle", "Vizyon başlığı bulunamadı")
        </h2>
        <p style="color: #fff;">
          @Html.Raw(sec.GetValueOrDefault("VizyonText", "<em>Vizyon metni yok</em>"))
        </p>
      </div>
    </div>
  </div>
</section>

@* Hakkımızda *@
<section id="hakkimizda" class="vh-100 d-flex align-items-center mt-4 bg-white">
  <div class="container">
    <div class="row gy-4">
      <div class="col-md-6 d-flex flex-column justify-content-center">
        <h2>
          @sec.GetValueOrDefault("HakkimizdaCTA_Title", "CTA başlığı bulunamadı")
        </h2>
        <p>
          @Html.Raw(sec.GetValueOrDefault("HakkimizdaCTA_Text", "<em>CTA metni yok</em>"))
        </p>
        <a href="@Url.Action("About","Home")" class="btn btn-primary">
          @sec.GetValueOrDefault("HakkimizdaCTA_Button", "Buton Metni")
        </a>
      </div>
      <div class="col-md-6 d-flex flex-column justify-content-center">
        <h2>
          @sec.GetValueOrDefault("HakkimizdaAbout_Title", "Hakkımızda başlığı bulunamadı")
        </h2>
        <p>
          @Html.Raw(sec.GetValueOrDefault("HakkimizdaAbout_Text", "<em>Hakkımızda metni yok</em>"))
        </p>
      </div>
    </div>
  </div>
</section>

@* İletişim CTA *@
<section id="iletisim-cta" class="bg-secondary text-white py-3">
  <div class="container d-flex justify-content-between align-items-center">
    <h5 class="mb-0">
      @sec.GetValueOrDefault("IletisimCTA_Text", "İletişim CTA metni bulunamadı")
    </h5>
    <a asp-controller="Home" asp-action="Contact" class="btn btn-light">
      @sec.GetValueOrDefault("IletisimCTA_Button", "Buton Metni")
    </a>
  </div>
</section>


@section Scripts {
  <partial name="_ValidationScriptsPartial" />
  <script>
    document.querySelectorAll('.card').forEach(c => {
      c.addEventListener('mouseenter', () => {
        c.style.boxShadow = '0 0 25px rgba(13, 110, 253, 0.4)';
      });
      c.addEventListener('mouseleave', () => {
        c.style.boxShadow = '';
      });
    });
    const inner = document.getElementById('heroInner');

    // Buton tıklamaları
    document.getElementById('btnToLogin').addEventListener('click', () => {
      inner.style.transform = 'translateY(-50%)';
    });
    document.getElementById('btnToRegister').addEventListener('click', () => {
      inner.style.transform = 'translateY(0)';
    });
  </script>
}
